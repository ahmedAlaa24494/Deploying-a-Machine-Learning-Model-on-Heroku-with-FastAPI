schema: '2.0'
stages:
  load_clean:
    cmd: python  src/stages/data_cleaning.py --config=params.yaml
    deps:
    - path: data/census.csv
      md5: 171eff96d34336df1a3d2d82bdb82fe3
      size: 3811654
    - path: src/stages/data_cleaning.py
      md5: 76cd83009321921cd382d85c2c4ce3cc
      size: 1160
    params:
      params.yaml:
        load_clean:
          dataset: data/census.csv
          output: data/clean_census.csv
    outs:
    - path: data/clean_census.csv
      md5: 137fa614aaae57f1ce34a19451bf9e2a
      size: 3362793
  test_clean:
    cmd: pytest  src/stages/test_data_cleaning.py
  data_split:
    cmd: python src/stages/data_split.py --config params.yaml
    deps:
    - path: data/clean_census.csv
      md5: 137fa614aaae57f1ce34a19451bf9e2a
      size: 3362793
    - path: src/stages/data_split.py
      md5: 734f57e1374f3834ad7a803314b4fde1
      size: 1143
    params:
      params.yaml:
        base.random_state: 42
        data_split:
          dataset: data/clean_census.csv
          test_size: 0.2
          output: data/train
    outs:
    - path: data/train/test_set.csv
      md5: 492bba6894c60daf0ae5e0a15bd364f0
      size: 671704
    - path: data/train/train_set.csv
      md5: 366aa0e1510c8bf040df913b632b8b76
      size: 2691198
  preprocess:
    cmd: python src/stages/preprocess.py --config=params.yaml
    deps:
    - path: data/train/test_set.csv
      md5: 492bba6894c60daf0ae5e0a15bd364f0
      size: 671704
    - path: data/train/train_set.csv
      md5: 366aa0e1510c8bf040df913b632b8b76
      size: 2691198
    - path: src/ml_model/data.py
      md5: e73e7e6556baf46187294101cc55a022
      size: 3087
    params:
      params.yaml:
        preprocess:
          target: salary
          categorical_features:
          - workclass
          - education
          - marital-status
          - occupation
          - relationship
          - race
          - sex
          - native-country
          numerical_features:
          - age
          - hours-per-week
          encoders_dir: artifacts/encoders
          output_dir: data/train/features
    outs:
    - path: artifacts/encoders/cat_features_encoder.gz
      md5: da2350dca3b5f7d92889eac096d953a6
      size: 1562
    - path: artifacts/encoders/label_encoder.gz
      md5: b7464afcf388e9d71e7f64cc6b8c6762
      size: 318
    - path: artifacts/encoders/num_features_encoder.gz
      md5: 219a4c81a0461ee7e9a1a946130b4043
      size: 445
    - path: data/train/features/x_test.npy
      md5: b4fb706224963fc82b755ad5ff5a5030
      size: 5418944
    - path: data/train/features/x_train.npy
      md5: c09fceb57df9f1f7d1a64eac2277b64c
      size: 21672064
    - path: data/train/features/y_test.npy
      md5: 62cfda3b17ff70e448640b935a49b951
      size: 52232
    - path: data/train/features/y_train.npy
      md5: 7d0560a2c1168e43110e5686bb12472f
      size: 208512
  train_model:
    cmd: python src/stages/train_model.py --config=params.yaml
    deps:
    - path: artifacts/encoders/cat_features_encoder.gz
      md5: da2350dca3b5f7d92889eac096d953a6
      size: 1562
    - path: artifacts/encoders/label_encoder.gz
      md5: b7464afcf388e9d71e7f64cc6b8c6762
      size: 318
    - path: artifacts/encoders/num_features_encoder.gz
      md5: 219a4c81a0461ee7e9a1a946130b4043
      size: 445
    - path: data/train/features/x_test.npy
      md5: b4fb706224963fc82b755ad5ff5a5030
      size: 5418944
    - path: data/train/features/x_train.npy
      md5: c09fceb57df9f1f7d1a64eac2277b64c
      size: 21672064
    - path: data/train/features/y_test.npy
      md5: 62cfda3b17ff70e448640b935a49b951
      size: 52232
    - path: data/train/features/y_train.npy
      md5: 7d0560a2c1168e43110e5686bb12472f
      size: 208512
    - path: src/ml_model/data.py
      md5: e73e7e6556baf46187294101cc55a022
      size: 3087
    - path: src/ml_model/model.py
      md5: ea891a9bb813e4f5ce2ed4e30fedcaf6
      size: 1574
    params:
      params.yaml:
        preprocess:
          target: salary
          categorical_features:
          - workclass
          - education
          - marital-status
          - occupation
          - relationship
          - race
          - sex
          - native-country
          numerical_features:
          - age
          - hours-per-week
          encoders_dir: artifacts/encoders
          output_dir: data/train/features
        train:
          model_type: GradientBoostingClassifier
          hp:
          - learning_rate: 0.1
          - max_depth: 5
          - min_samples_leaf: 1
          - min_samples_split: 2
          - n_estimators: 100
          model_artifact: artifacts/model/census-gradient-boosting-classifier.gz
    outs:
    - path: artifacts/model/census-gradient-boosting-classifier.gz
      md5: 901ac2061bedfa7d0615118917a2316d
      size: 180811
    - path: reports/metrics.json
      md5: 4b2a08960df75d3b9ac36c71db870a45
      size: 136
